//
//  NationalGalarPokedexUITests.swift
//  NationalGalarPokedexUITests
//
//  Created by Hector Villasano on 7/21/20.
//  Copyright © 2020 s. All rights reserved.
//

import XCTest

@testable import NationalGalarPokedex

class NationalGalarPokedexUITests: XCTestCase {
    var app: XCUIApplication! = nil
    let nationalPokemonNames = fetchNationalPokemonNames.split(separator: ",")
    let galarPokemonNames = fetchGalarPokemonNames.split(separator: ",")
    
    var searchNavigationBar: XCUIElement {
        app.navigationBars["PokedexSearchNavigationBar"]
    }
    
    var pokedexListTableView: XCUIElement {
        app.tables["PokedexListTableView"]
    }
    
    var rightBarButtonItemMagnifyingglass: XCUIElement {
        searchNavigationBar.buttons["rightBarButtonItemMagnifyingglass"]
    }
    
    var leftBarButtonItemGear: XCUIElement {
        searchNavigationBar.buttons["leftBarButtonItemGear"]
    }
    
    var searchTabBarButton: XCUIElement {
        app.tabBars.buttons["Search"]
    }
    
    var favoritesTabBarButton: XCUIElement {
        app.tabBars.buttons["Favorites"]
    }
    
    var leagueCardTabBarButton: XCUIElement {
        app.tabBars.buttons["League Cards"]
    }

    override func setUpWithError() throws {
        continueAfterFailure = false
        app = XCUIApplication()
        app.launch()
    }

    override func tearDownWithError() throws {
        sleep(1)
        app.terminate()
    }
}

extension NationalGalarPokedexUITests {
    func testPokedexSearchNavigationBarIsHittable() throws {
        XCTAssert(searchNavigationBar.isHittable)
    }
    
    func testpokedexListTableViewIsHittable() throws {
        XCTAssert(pokedexListTableView.isHittable)
    }
    
    func testTabBarButtonsIsHittable() {
        XCTAssert(searchTabBarButton.isHittable)
        XCTAssert(favoritesTabBarButton.isHittable)
        XCTAssert(leagueCardTabBarButton.isHittable)
    }

    func testTBulbasaurDetailViewFlow() throws {
        pokedexListTableView.cells["BulbasaurCell"].tap()
        
        XCTAssert(app.navigationBars["BulbasaurDetailView"].isHittable)
        
        let playPauseButton = app.buttons["playpause"]
        
        XCTAssert(playPauseButton.isHittable)
        playPauseButton.tap()
        
        let tablesQuery = app.tables
        
        tablesQuery.buttons["Description"].tap()
        sleep(1)
        
        tablesQuery.staticTexts["National:  #1"].tap()
        sleep(1)
        
        tablesQuery.staticTexts["NO."].tap()
        sleep(1)
        
        tablesQuery.staticTexts["Type"].tap()
        sleep(1)
        
        tablesQuery.staticTexts["Height & Weight"].tap()
        sleep(1)
        
        app.swipeUp()
        app.swipeUp()
        app.swipeUp()
                
        searchTabBarButton.tap()
        XCTAssert(searchNavigationBar.isHittable)
    }
    
    func testPokemonNameListNotNil() {
        XCTAssertNotNil(nationalPokemonNames)
        XCTAssertNotNil(galarPokemonNames)
        
    }
}

// MARK: METRICS
extension NationalGalarPokedexUITests {
    func _testLaunchPerformance() throws {
        if #available(macOS 10.15, iOS 13.0, tvOS 13.0, *) {
            measure(metrics: [XCTOSSignpostMetric.applicationLaunch]) {
                XCUIApplication().launch()
            }
        }
    }
}

private let fetchNationalPokemonNames = """
Bulbasaur,
Ivysaur,
Venusaur,
Charmander,
Charmeleon,
Charizard,
Squirtle,
Wartortle,
Blastoise,
Caterpie,
Metapod,
Butterfree,
Pikachu,
Raichu,
Clefairy,
Clefable,
Vulpix,
Ninetales,
Oddish,
Gloom,
Vileplume,
Diglett,
Dugtrio,
Meowth,
Persian,
Growlithe,
Arcanine,
Machop,
Machoke,
Machamp,
Ponyta,
Rapidash,
Farfetch’d,
Shellder,
Cloyster,
Gastly,
Haunter,
Gengar,
Onix,
Krabby,
Kingler,
Hitmonlee,
Hitmonchan,
Koffing,
Weezing,
Rhyhorn,
Rhydon,
Goldeen,
Seaking,
Mr. Mime,
Magikarp,
Gyarados,
Lapras,
Ditto,
Eevee,
Vaporeon,
Jolteon,
Flareon,
Snorlax,
Mewtwo,
Mew,
Hoothoot,
Noctowl,
Chinchou,
Lanturn,
Pichu,
Cleffa,
Togepi,
Togetic,
Natu,
Xatu,
Bellossom,
Sudowoodo,
Wooper,
Quagsire,
Espeon,
Umbreon,
Wobbuffet,
Steelix,
Qwilfish,
Shuckle,
Sneasel,
Swinub,
Piloswine,
Corsola,
Remoraid,
Octillery,
Delibird,
Mantine,
Tyrogue,
Hitmontop,
Larvitar,
Pupitar,
Tyranitar,
Celebi,
Zigzagoon,
Linoone,
Lotad,
Lombre,
Ludicolo,
Seedot,
Nuzleaf,
Shiftry,
Wingull,
Pelipper,
Ralts,
Kirlia,
Gardevoir,
Nincada,
Ninjask,
Shedinja,
Sableye,
Mawile,
Electrike,
Manectric,
Roselia,
Wailmer,
Wailord,
Torkoal,
Trapinch,
Vibrava,
Flygon,
Lunatone,
Solrock,
Barboach,
Whiscash,
Corphish,
Crawdaunt,
Baltoy,
Claydol,
Feebas,
Milotic,
Duskull,
Dusclops,
Wynaut,
Snorunt,
Glalie,
Jirachi,
Budew,
Roserade,
Combee,
Vespiquen,
Cherubi,
Cherrim,
Shellos,
Gastrodon,
Drifloon,
Drifblim,
Stunky,
Skuntank,
Bronzor,
Bronzong,
Bonsly,
Mime Jr.,
Munchlax,
Riolu,
Lucario,
Hippopotas,
Hippowdon,
Skorupi,
Drapion,
Croagunk,
Toxicroak,
Mantyke,
Snover,
Abomasnow,
Weavile,
Rhyperior,
Togekiss,
Leafeon,
Glaceon,
Mamoswine,
Gallade,
Dusknoir,
Froslass,
Rotom,
Purrloin,
Liepard,
Munna,
Musharna,
Pidove,
Tranquill,
Unfezant,
Roggenrola,
Boldore,
Gigalith,
Woobat,
Swoobat,
Drilbur,
Excadrill,
Timburr,
Gurdurr,
Conkeldurr,
Tympole,
Palpitoad,
Seismitoad,
Throh,
Sawk,
Cottonee,
Whimsicott,
Basculin,
Darumaka,
Darmanitan,
Maractus,
Dwebble,
Crustle,
Scraggy,
Scrafty,
Sigilyph,
Yamask,
Cofagrigus,
Trubbish,
Garbodor,
Minccino,
Cinccino,
Gothita,
Gothorita,
Gothitelle,
Solosis,
Duosion,
Reuniclus,
Vanillite,
Vanillish,
Vanilluxe,
Karrablast,
Escavalier,
Frillish,
Jellicent,
Joltik,
Galvantula,
Ferroseed,
Ferrothorn,
Klink,
Klang,
Klinklang,
Elgyem,
Beheeyem,
Litwick,
Lampent,
Chandelure,
Axew,
Fraxure,
Haxorus,
Cubchoo,
Beartic,
Shelmet,
Accelgor,
Stunfisk,
Golett,
Golurk,
Pawniard,
Bisharp,
Rufflet,
Braviary,
Vullaby,
Mandibuzz,
Heatmor,
Durant,
Deino,
Zweilous,
Hydreigon,
Cobalion,
Terrakion,
Virizion,
Reshiram,
Zekrom,
Kyurem,
Keldeo,
Bunnelby,
Diggersby,
Pancham,
Pangoro,
Espurr,
Meowstic,
Honedge,
Doublade,
Aegislash,
Spritzee,
Aromatisse,
Swirlix,
Slurpuff,
Inkay,
Malamar,
Binacle,
Barbaracle,
Helioptile,
Heliolisk,
Sylveon,
Hawlucha,
Goomy,
Sliggoo,
Goodra,
Phantump,
Trevenant,
Pumpkaboo,
Gourgeist,
Bergmite,
Avalugg,
Noibat,
Noivern,
Rowlet,
Dartrix,
Decidueye,
Litten,
Torracat,
Incineroar,
Popplio,
Brionne,
Primarina,
Grubbin,
Charjabug,
Vikavolt,
Cutiefly,
Ribombee,
Wishiwashi,
Mareanie,
Toxapex,
Mudbray,
Mudsdale,
Dewpider,
Araquanid,
Morelull,
Shiinotic,
Salandit,
Salazzle,
Stufful,
Bewear,
Bounsweet,
Steenee,
Tsareena,
Oranguru,
Passimian,
Wimpod,
Golisopod,
Pyukumuku,
Type: Null,
Silvally,
Turtonator,
Togedemaru,
Mimikyu,
Drampa,
Dhelmise,
Jangmo-o,
Hakamo-o,
Kommo-o,
Cosmog,
Cosmoem,
Solgaleo,
Lunala,
Necrozma,
Marshadow,
Zeraora,
Meltan,
Melmetal,
Grookey,
Thwackey,
Rillaboom,
Scorbunny,
Raboot,
Cinderace,
Sobble,
Drizzile,
Inteleon,
Skwovet,
Greedent,
Rookidee,
Corvisquire,
Corviknight,
Blipbug,
Dottler,
Orbeetle,
Nickit,
Thievul,
Gossifleur,
Eldegoss,
Wooloo,
Dubwool,
Chewtle,
Drednaw,
Yamper,
Boltund,
Rolycoly,
Carkol,
Coalossal,
Applin,
Flapple,
Appletun,
Silicobra,
Sandaconda,
Cramorant,
Arrokuda,
Barraskewda,
Toxel,
Toxtricity,
Sizzlipede,
Centiskorch,
Clobbopus,
Grapploct,
Sinistea,
Polteageist,
Hatenna,
Hattrem,
Hatterene,
Impidimp,
Morgrem,
Grimmsnarl,
Obstagoon,
Perrserker,
Cursola,
Sirfetch’d,
Mr. Rime,
Runerigus,
Milcery,
Alcremie,
Falinks,
Pincurchin,
Snom,
Frosmoth,
Stonjourner,
Eiscue,
Indeedee,
Morpeko,
Cufant,
Copperajah,
Dracozolt,
Arctozolt,
Dracovish,
Arctovish,
Duraludon,
Dreepy,
Drakloak,
Dragapult,
Zacian,
Zamazenta,
Eternatus,
"""

private let fetchGalarPokemonNames = """
Grookey,
Thwackey,
Rillaboom,
Scorbunny,
Raboot,
Cinderace,
Sobble,
Drizzile,
Inteleon,
Blipbug,
Dottler,
Orbeetle,
Caterpie,
Metapod,
Butterfree,
Grubbin,
Charjabug,
Vikavolt,
Hoothoot,
Noctowl,
Rookidee,
Corvisquire,
Corviknight,
Skwovet,
Greedent,
Pidove,
Tranquill,
Unfezant,
Nickit,
Thievul,
Zigzagoon,
Linoone,
Obstagoon,
Wooloo,
Dubwool,
Lotad,
Lombre,
Ludicolo,
Seedot,
Nuzleaf,
Shiftry,
Chewtle,
Drednaw,
Purrloin,
Liepard,
Yamper,
Boltund,
Bunnelby,
Diggersby,
Minccino,
Cinccino,
Bounsweet,
Steenee,
Tsareena,
Oddish,
Gloom,
Vileplume,
Bellossom,
Budew,
Roselia,
Roserade,
Wingull,
Pelipper,
Joltik,
Galvantula,
Electrike,
Manectric,
Vulpix,
Ninetales,
Growlithe,
Arcanine,
Vanillite,
Vanillish,
Vanilluxe,
Swinub,
Piloswine,
Mamoswine,
Delibird,
Snorunt,
Glalie,
Froslass,
Baltoy,
Claydol,
Mudbray,
Mudsdale,
Dwebble,
Crustle,
Golett,
Golurk,
Munna,
Musharna,
Natu,
Xatu,
Stufful,
Bewear,
Snover,
Abomasnow,
Krabby,
Kingler,
Wooper,
Quagsire,
Corphish,
Crawdaunt,
Nincada,
Ninjask,
Shedinja,
Tyrogue,
Hitmonlee,
Hitmonchan,
Hitmontop,
Pancham,
Pangoro,
Klink,
Klang,
Klinklang,
Combee,
Vespiquen,
Bronzor,
Bronzong,
Ralts,
Kirlia,
Gardevoir,
Gallade,
Drifloon,
Drifblim,
Gossifleur,
Eldegoss,
Cherubi,
Cherrim,
Stunky,
Skuntank,
Tympole,
Palpitoad,
Seismitoad,
Duskull,
Dusclops,
Dusknoir,
Machop,
Machoke,
Machamp,
Gastly,
Haunter,
Gengar,
Magikarp,
Gyarados,
Goldeen,
Seaking,
Remoraid,
Octillery,
Shellder,
Cloyster,
Feebas,
Milotic,
Basculin,
Wishiwashi,
Pyukumuku,
Trubbish,
Garbodor,
Sizzlipede,
Centiskorch,
Rolycoly,
Carkol,
Coalossal,
Diglett,
Dugtrio,
Drilbur,
Excadrill,
Roggenrola,
Boldore,
Gigalith,
Timburr,
Gurdurr,
Conkeldurr,
Woobat,
Swoobat,
Noibat,
Noivern,
Onix,
Steelix,
Arrokuda,
Barraskewda,
Meowth,
Perrserker,
Persian,
Milcery,
Alcremie,
Cutiefly,
Ribombee,
Ferroseed,
Ferrothorn,
Pumpkaboo,
Gourgeist,
Pichu,
Pikachu,
Raichu,
Eevee,
Vaporeon,
Jolteon,
Flareon,
Espeon,
Umbreon,
Leafeon,
Glaceon,
Sylveon,
Applin,
Flapple,
Appletun,
Espurr,
Meowstic,
Swirlix,
Slurpuff,
Spritzee,
Aromatisse,
Dewpider,
Araquanid,
Wynaut,
Wobbuffet,
Farfetch’d,
Sirfetch’d,
Chinchou,
Lanturn,
Croagunk,
Toxicroak,
Scraggy,
Scrafty,
Stunfisk,
Shuckle,
Barboach,
Whiscash,
Shellos,
Gastrodon,
Wimpod,
Golisopod,
Binacle,
Barbaracle,
Corsola,
Cursola,
Impidimp,
Morgrem,
Grimmsnarl,
Hatenna,
Hattrem,
Hatterene,
Salandit,
Salazzle,
Pawniard,
Bisharp,
Throh,
Sawk,
Koffing,
Weezing,
Bonsly,
Sudowoodo,
Cleffa,
Clefairy,
Clefable,
Togepi,
Togetic,
Togekiss,
Munchlax,
Snorlax,
Cottonee,
Whimsicott,
Rhyhorn,
Rhydon,
Rhyperior,
Gothita,
Gothorita,
Gothitelle,
Solosis,
Duosion,
Reuniclus,
Karrablast,
Escavalier,
Shelmet,
Accelgor,
Elgyem,
Beheeyem,
Cubchoo,
Beartic,
Rufflet,
Braviary,
Vullaby,
Mandibuzz,
Skorupi,
Drapion,
Litwick,
Lampent,
Chandelure,
Inkay,
Malamar,
Sneasel,
Weavile,
Sableye,
Mawile,
Maractus,
Sigilyph,
Riolu,
Lucario,
Torkoal,
Mimikyu,
Cufant,
Copperajah,
Qwilfish,
Frillish,
Jellicent,
Mareanie,
Toxapex,
Cramorant,
Toxel,
Toxtricity,
Silicobra,
Sandaconda,
Hippopotas,
Hippowdon,
Durant,
Heatmor,
Helioptile,
Heliolisk,
Hawlucha,
Trapinch,
Vibrava,
Flygon,
Axew,
Fraxure,
Haxorus,
Yamask,
Runerigus,
Cofagrigus,
Honedge,
Doublade,
Aegislash,
Ponyta,
Rapidash,
Sinistea,
Polteageist,
Indeedee,
Phantump,
Trevenant,
Morelull,
Shiinotic,
Oranguru,
Passimian,
Morpeko,
Falinks,
Drampa,
Turtonator,
Togedemaru,
Snom,
Frosmoth,
Clobbopus,
Grapploct,
Pincurchin,
Mantyke,
Mantine,
Wailmer,
Wailord,
Bergmite,
Avalugg,
Dhelmise,
Lapras,
Lunatone,
Solrock,
Mime Jr.,
Mr. Mime,
Mr. Rime,
Darumaka,
Darmanitan,
Stonjourner,
Eiscue,
Duraludon,
Rotom,
Ditto,
Dracozolt,
Arctozolt,
Dracovish,
Arctovish,
Charmander,
Charmeleon,
Charizard,
Type: Null,
Silvally,
Larvitar,
Pupitar,
Tyranitar,
Deino,
Zweilous,
Hydreigon,
Goomy,
Sliggoo,
Goodra,
Jangmo-o,
Hakamo-o,
Kommo-o,
Dreepy,
Drakloak,
Dragapult,
Zacian,
Zamazenta,
Eternatus,
"""
